langsam_with_optflow_node:
  ros__parameters:
    # 基本LangSAMパラメータ
    sam_model: "sam2.1_hiera_small"
    text_prompt: "white line. red pylon. human. wall. car. building. mobility. road."
    box_threshold: 0.3
    text_threshold: 0.2
    tracking_targets: "white line. red pylon. human. car."
    
    # 実行間隔パラメータ（最適化版）
    grounding_dino_interval: 0.1  # GroundingDINO実行間隔（秒）
    sam2_interval: 0.1  # SAM2実行間隔（秒）
    enable_sam2_every_frame: true  # SAM2毎フレーム実行
    
    # 非同期処理設定
    enable_async_grounding_dino: true  # GroundingDINOの非同期処理を有効化
    enable_async_sam2: true  # SAM2の非同期処理を有効化
    enable_parallel_feature_processing: true  # 特徴点処理の並列化を有効化
    feature_processing_workers: 4  # 特徴点処理の並列ワーカー数
    
    # 時間整合性設定
    enable_temporal_alignment: true  # 時間整合性を有効化
    max_temporal_gap: 1.0  # 最大時間ギャップ（秒）
    image_buffer_size: 60  # 画像バッファサイズ（フレーム数）
    catchup_threshold: 0.05  # キャッチアップ処理の閾値（秒）
    optical_flow_interpolation_threshold: 0.1  # オプティカルフロー補間の閾値（秒）
    
    # 追跡統合設定
    enable_tracking_integration: true  # 既存追跡と新規検出の統合を有効化
    overlap_iou_threshold: 0.3  # 重複判定のIoU閾値
    overlap_distance_threshold: 100.0  # 重複判定の距離閾値（ピクセル）
    merge_weight_existing: 0.7  # マージ時の既存追跡の重み
    merge_weight_new: 0.3  # マージ時の新規検出の重み
    detection_timeout: 2.0  # 検出されないオブジェクトの削除タイムアウト（秒）
    
    # Harris corner検出パラメータ（最適化版）
    harris_max_corners: 5  # バウンディングボックス内の最大特徴点数
    harris_quality_level: 0.02  # Harris corner品質レベル
    harris_min_distance: 15  # Harris corner間の最小距離
    harris_block_size: 3  # Harris corner検出ブロックサイズ
    harris_k: 0.04  # Harris検出器のkパラメータ
    use_harris_detector: true  # Harris検出器使用（false=Shi-Tomasi）
    
    # 特徴点選択パラメータ
    feature_selection_method: "center_point"  # 特徴点選択方法
    
    # エッジ検出パラメータ
    canny_low_threshold: 50   # Canny edge検出の低閾値
    canny_high_threshold: 150 # Canny edge検出の高閾値
    min_edge_pixels: 10       # 有効とみなす最小エッジピクセル数
    
    # オプティカルフローパラメータ（最適化版）
    optical_flow_win_size_x: 21  # オプティカルフローウィンドウサイズX
    optical_flow_win_size_y: 21  # オプティカルフローウィンドウサイズY
    optical_flow_max_level: 3  # ピラミッドの最大レベル
    optical_flow_criteria_eps: 0.01  # 収束判定のイプシロン値
    optical_flow_criteria_max_count: 15  # 最大反復回数
    
    # 追跡検証パラメータ
    max_displacement: 50.0  # 最大変位閾値（ピクセル）
    min_valid_ratio: 0.5  # 有効な追跡点の最小割合
    
    # CUDA設定パラメータ
    cuda_arch_list: "6.0;6.1;7.0;7.5;8.0;8.6"
    force_cpu_mode: false
    
    # パフォーマンス設定
    enable_torch_no_grad: true
    enable_memory_optimization: true
    enable_gpu_memory_cleanup: true
    
    # ログ設定
    enable_parameter_logging: true
    enable_fps_logging: true
    log_level_override: ""  

